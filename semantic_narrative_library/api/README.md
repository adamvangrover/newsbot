# Semantic Narrative Library - API Backend

This directory contains the FastAPI backend for the Semantic Narrative Library.

## Overview

The API provides HTTP endpoints to interact with the knowledge graph and reasoning engine. It allows users to:
- Query entities (companies, industries, macro-indicators), drivers, and relationships.
- Retrieve structured explanations and narratives generated by the reasoning engine (and eventually, integrated LLMs).

## Key Components:

-   **`main.py`**: The main FastAPI application file. It defines:
    -   The FastAPI app instance.
    -   Startup logic to load the knowledge graph data (from `semantic_narrative_library/data/sample_knowledge_graph.json`) and initialize the `SimpleReasoner`.
    -   API endpoint definitions for various functionalities.

## Running the API:

1.  **Prerequisites**:
    *   Python 3.8+
    *   Ensure all dependencies are installed from `semantic_narrative_library/requirements.txt`. (Run `pip install -r semantic_narrative_library/requirements.txt` from the repository root).

2.  **Execution**:
    *   Navigate to the root directory of this repository (the parent of `semantic_narrative_library`).
    *   Run the Uvicorn server:
        ```bash
        uvicorn semantic_narrative_library.api.main:app --reload --port 8000
        ```
    *   `--reload`: Enables auto-reloading on code changes (useful for development).
    *   `--port 8000`: Specifies the port (default is 8000).

3.  **Accessing the API**:
    *   Once running, the API will be accessible at `http://127.0.0.1:8000`.
    *   **Interactive API Documentation (Swagger UI)**: `http://127.0.0.1:8000/docs`
    *   **Alternative API Documentation (ReDoc)**: `http://127.0.0.1:8000/redoc`
    *   **OpenAPI Schema**: `http://127.0.0.1:8000/openapi.json`

## Endpoints:

Refer to the interactive API documentation (`/docs` or `/redoc`) for a detailed and up-to-date list of endpoints, request parameters, and response models. Key endpoints include:
- `/entities/{entity_id}`: Get details for a specific entity.
- `/drivers/{driver_id}`: Get details for a specific driver.
- `/companies/{company_id}/details`: Get details for a company.
- `/companies/{company_id}/direct_drivers`: Get drivers directly affecting a company.
- `/companies/{company_id}/narrative`: Get a generated narrative for a company.
- `/knowledge_graph/stats`: Get basic statistics about the loaded data.

## Dependencies:

-   FastAPI: For building the API.
-   Uvicorn: ASGI server to run the FastAPI application.
-   Pydantic: For data validation and settings management (used by core models).
-   Other dependencies are listed in `semantic_narrative_library/requirements.txt`.

## Data Source:

On startup, the API loads data from `semantic_narrative_library/data/sample_knowledge_graph.json` using the `load_knowledge_graph_from_json` utility and initializes the `SimpleReasoner` from `semantic_narrative_library/reasoning_engine/simple_reasoner.py`.

## Future Enhancements:

-   More sophisticated error handling and logging.
-   Authentication and authorization mechanisms.
-   Integration with a persistent database instead of in-memory loading for larger datasets.
-   Asynchronous operations for long-running reasoning tasks.
-   Endpoints for real LLM integration.
