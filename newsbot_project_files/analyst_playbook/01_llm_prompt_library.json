{
  "library_name": "DynamicFinancialReporterPromptSet",
  "version": "1.0.0",
  "description": "A library of prompts to guide an LLM in generating comprehensive financial reports by dynamically assessing its environment and capabilities.",
  "global_placeholders": [
    {"name": "[Company Name]", "description": "The primary name of the company for the report."},
    {"name": "[Ticker Symbol]", "description": "The stock ticker symbol for the company (if available)."},
    {"name": "[Report Date]", "description": "The date the report is being generated (e.g., YYYY-MM-DD)."},
    {"name": "[User Name]", "description": "Optional: Name of the user requesting the report, for personalization."},
    {"name": "[Report Depth]", "description": "User's preference for report depth (e.g., 'brief summary', 'detailed analysis', 'executive overview')."}
  ],
  "prompt_categories": {
    "1_orchestration": {
      "description": "Initial prompts to start the reporting process and guide overall LLM behavior.",
      "prompts": {
        "main_orchestrator": {
          "title": "Main Report Orchestrator",
          "purpose": "Guides the LLM through environment assessment, data gathering, analysis, and report generation.",
          "template": "You are an expert financial analyst AI. Your task is to generate a comprehensive financial report for [Company Name] (Ticker: [Ticker Symbol], if provided). Today's date is [Report Date]. This report is being prepared for [User Name] and should be a [Report Depth] analysis.\n\nTo accomplish this, you will follow a structured process, adapting to the tools and information sources available to you. Please proceed step-by-step:\n\n**Phase 1: Understand Your Capabilities & Environment**\n   1.  **Self-Reflection:** Access and list your available tools (e.g., 'web_search', 'code_interpreter', specific API connectors like 'NewsBot_API_access'). Detail any knowledge cut-off dates.\n       *Goal: To understand what tools and data you can leverage.*\n   2.  **Strategy Formulation:** Based on your capabilities, outline the primary strategy you will use for data gathering (e.g., rely on general web search, prioritize NewsBot API if available, use code interpreter for structured data).\n       *Goal: To choose the most effective path based on available resources.*\n\n**Phase 2: Company Identification & Initial Data Gathering**\n   (Use prompts from '3_data_gathering.3a_company_identification' if necessary to confirm company details from ticker/name)\n   1.  **Company Profile:** Gather essential company profile information (e.g., official website, industry, key executives, business description).\n       *If NewsBot_API_access is available and provides profile data, use it (refer to '3_data_gathering.3c_newsbot_api_interaction.query_newsbot_company_analysis' and 'interpret_newsbot_profile').*\n       *Otherwise, use generic web search (refer to '3_data_gathering.3b_generic_web_search.fetch_official_website_profile').*\n   2.  **Recent News Aggregation:** Collect significant news articles and press releases concerning [Company Name] from the last 3-6 months (or as specified by [Report Depth]).\n       *If NewsBot_API_access is available, prioritize its news fetching capabilities, including any pre-processed sentiment or categorization (refer to '3_data_gathering.3c_newsbot_api_interaction.query_newsbot_company_analysis' and 'interpret_newsbot_news_sentiment').*\n       *Otherwise, use generic web search (refer to '3_data_gathering.3b_generic_web_search.search_recent_news_general').*\n   3.  **Financial Data (Basic):** Attempt to find recent quarterly/annual financial highlights (revenue, profit/loss, key trends).\n       *If NewsBot_API_access provides stock data or financial summaries, use it (refer to '3_data_gathering.3c_newsbot_api_interaction.interpret_newsbot_stock_data').*\n       *If code interpreter and access to financial databases are available, consider using them (refer to '3_data_gathering.3d_structured_data_sources.query_financial_statements').*\n       *Otherwise, use generic web search for earnings reports or summaries (refer to '3_data_gathering.3b_generic_web_search.find_earnings_reports_transcripts').*\n\n**Phase 3: In-Depth Analysis and Synthesis**\n   (Refer to prompts in '4_analysis_and_synthesis' as needed for each sub-task below)\n   1.  **News Analysis:**\n       a.  Analyze sentiment of collected news.\n       b.  Identify key themes and topics from the news.\n   2.  **Catalyst Identification:** Based on all gathered information, identify potential upcoming catalysts (positive or negative) for [Company Name] and, where possible, estimate their timelines and potential impact.\n   3.  **Other Relevant Analysis (as per [Report Depth] and your capabilities):**\n       a.  Consider generating a SWOT analysis (Strengths, Weaknesses, Opportunities, Threats).\n       b.  Provide a brief competitor overview if information is readily available.\n       c.  Summarize key risks facing the company.\n       d.  Analyze market trends relevant to [Company Name]'s industry.\n   4.  **Overall Synthesis:** Synthesize all findings into a coherent outlook for [Company Name].\n\n**Phase 4: Report Compilation and Citation**\n   (Refer to prompts in '5_reporting_and_citation' as needed)\n   1.  **Draft Report:** Compile all analyzed information into a structured report.\n   2.  **Executive Summary:** If [Report Depth] requires it (e.g., 'detailed analysis', 'executive overview'), generate a concise executive summary.\n   3.  **Methodology & Confidence:** Briefly describe the primary methods and sources used, and your confidence level in the findings based on data availability and quality.\n   4.  **Citations:** Provide citations for all key pieces of information and direct quotes, referencing source URLs or document names.\n\n**Operational Guidelines:**\n*   **Chained Thinking:** For complex queries, break them down into smaller, manageable steps. Document your intermediate findings if it helps.\n*   **Tool Usage:** When using a tool (like web search), clearly state the query you are using and summarize the direct result before analyzing it.\n*   **Information Verification:** If possible, try to corroborate critical information from multiple sources. Note any discrepancies found.\n*   **Structured Output (for this orchestration):** As you complete each major phase and sub-task, provide a brief confirmation or summary of findings for that part before proceeding to the next. This will help track progress. If a step is impossible due to capability limitations, state that clearly and explain why.\n\nBegin with Phase 1, Step 1 (Self-Reflection). I will await your output for each phase before guiding you further if needed, or you can proceed through all phases if you are confident."
        }
      }
    },
    "2_environment_assessment": {
      "description": "Prompts to help the LLM understand its own capabilities and available tools.",
      "prompts": {
        "capability_self_reflection": {
          "title": "Capability Self-Reflection",
          "purpose": "Instructs the LLM to list its available tools, knowledge cut-off, and specific API access (like NewsBot).",
          "template": "**Capability Self-Reflection Protocol**\n\nAs the first step in generating the financial report for [Company Name], please perform a detailed self-assessment of your current capabilities and environment. Provide the information as a JSON object with keys: 'available_tools' (list of objects, each with 'name' and 'description'), 'knowledge_cutoff_date' (string YYYY-MM-DD), 'api_access' (object, e.g., 'newsbot_api': {'available': true/false, 'endpoints': ['endpoint1', 'endpoint2']}), 'output_formats' (list of strings), 'constraints' (list of strings), 'ethical_guidelines_summary' (string).\n\nSpecifically, detail the following:\n1.  **Available Tools:** List all functional tools/plugins (e.g., `web_search`, `code_interpreter`). For each, briefly describe its function.\n2.  **Knowledge Base:** Your general knowledge cut-off date. Can you access real-time information?\n3.  **Specific API Access (e.g., NewsBot API):** Can you interact with a 'NewsBot API'? If yes, what endpoints/functions (e.g., `get_company_profile`, `get_company_news`)? Expected inputs and data formats?\n4.  **Data Handling & Output:** Can you process info from multiple sources? What report formats can you generate? Any output restrictions (length, complexity)?\n5.  **Constraints & Limitations:** Any website access restrictions? Relevant ethical/content policies for this task?"
        },
        "strategy_selection_guide": {
          "title": "Strategy Selection Guide",
          "purpose": "Helps the LLM decide which data gathering/analysis paths to take based on its self-assessed capabilities.",
          "template": "**Strategy Formulation Protocol for [Company Name] Report**\n\nBased on your self-assessed capabilities (from 'Capability Self-Reflection Protocol'), outline your primary strategy for gathering and analyzing information for the [Company Name] report. Address:\n1.  **Primary Data Gathering Methods:** For company profile, recent news, and basic financial data, what are your primary methods (e.g., NewsBot API, web_search, code_interpreter)? Be specific.\n2.  **Contingency Plans:** If a primary method fails (e.g., NewsBot API unavailable for news), what's your fallback for that data type?\n3.  **Adaptation for [Report Depth]:** How will the requested [Report Depth] influence your information seeking (e.g., 'brief summary' vs. 'detailed analysis')?\n4.  **Addressing Gaps:** How will you handle an old knowledge cut-off date or lack of a specific tool for certain data (e.g., direct stock database access)?\n5.  **Confidence:** State your confidence in this strategy. Output this strategy outline as a structured plan (e.g., markdown or JSON)."
        }
      }
    },
    "3_data_gathering": {
      "description": "Prompts for acquiring information from various sources.",
      "sub_categories": {
        "3a_company_identification": {
            "description": "Prompts to confirm company identity from name/ticker.",
            "prompts": {
                "confirm_company_from_ticker": {
                    "title": "Confirm Company from Ticker",
                    "purpose": "Given [Ticker Symbol], confirm the full [Company Name] and its primary stock exchange.",
                    "template": "**Company Identification Protocol: Ticker to Company**\n\nInput:\n- Ticker Symbol: [Ticker Symbol]\n- (Optional) Expected Company Name: [Company Name]\n\nTasks:\n1. Using available tools, confirm full official company name for [Ticker Symbol], its primary stock exchange, and corporate/investor website URL.\n2. If 'Expected Company Name' was provided, verify match and note discrepancies.\n\nOutput Desired (as a JSON object):\n{\n  \"official_company_name\": \"<identified_name>\",\n  \"primary_stock_exchange\": \"<exchange_name>\",\n  \"corporate_website_url\": \"<url>\",\n  \"verification_notes\": \"<notes>\"\n}"
                },
                "find_ticker_from_company_name": {
                    "title": "Find Ticker from Company Name",
                    "purpose": "Given [Company Name], find its primary [Ticker Symbol] and stock exchange.",
                    "template": "**Company Identification Protocol: Company Name to Ticker**\n\nInput:\n- Company Name: [Company Name]\n\nTasks:\n1. Using available tools, find primary stock ticker for [Company Name], its primary stock exchange, and corporate/investor website URL. Focus on primary listing.\n\nOutput Desired (as a JSON object):\n{\n  \"identified_ticker_symbol\": \"<ticker_symbol>\",\n  \"primary_stock_exchange\": \"<exchange_name>\",\n  \"corporate_website_url\": \"<url>\",\n  \"confidence_score\": \"<High/Medium/Low>\",\n  \"ambiguity_notes\": \"<notes>\"\n}"
                }
            }
        },
        "3b_generic_web_search": {
          "description": "Prompts for using general web search tools.",
          "prompts": {
            "fetch_official_website_profile": "**Web Search: Official Company Profile**\n\nUsing web search, find the official corporate website for [Company Name] (Ticker: [Ticker Symbol], if known). From 'About Us' or 'Investor Relations' sections, extract: brief company description/mission, key business segments/products, HQ location, key executives (CEO, CFO). Summarize concisely. Cite main URL used. Present extracted data as a JSON object with keys like 'description', 'segments', 'hq_location', 'key_executives', 'source_url'.",
            "search_recent_news_general": "**Web Search: Recent News (General)**\n\nPerform web searches for significant news articles, press releases, and financial reports on [Company Name] from the last 3-6 months (align with [Report Depth] and [Report Date]). Prioritize reputable financial news, official releases, regulatory filings. For 5-10 key items (adjust per [Report Depth]), list them as a JSON array, each object with keys: 'headline', 'source', 'publication_date', 'summary' (1-2 sentences), 'url'.",
            "find_earnings_reports_transcripts": "**Web Search: Earnings Reports/Transcripts**\n\nSearch for latest quarterly/annual earnings reports and conference call transcripts for [Company Name]. Focus on company's Investor Relations or reputable aggregators. For the most recent report/transcript, summarize key financial highlights (Revenue, Net Income, EPS), core management messages, and provide URL. Output as a JSON object: {\"report_period\": \"QX YYYY\", \"release_date\": \"YYYY-MM-DD\", \"financial_highlights\": {\"revenue\": X, ...}, \"management_commentary_summary\": \"...", \"report_url\": \"..."}",
            "search_analyst_ratings_opinions": "**Web Search: Analyst Ratings/Opinions**\n\nSearch for recent (last 1-3 months) analyst ratings, price targets, and summarized opinions for [Company Name] (Ticker: [Ticker Symbol]). Use reputable financial news or analyst aggregators. Summarize: general consensus (Buy/Hold/Sell), range of price targets, key reasons for ratings. Cite sources/dates. Output as JSON: {\"consensus\": \"...", \"price_target_range\": \"...", \"key_analyst_reasons\": [\"reason1\", ...], \"sources_cited\": [\"source_info\", ...]}"
          }
        },
        "3c_newsbot_api_interaction": {
          "description": "Prompts for interacting with the NewsBot API (if available).",
          "prompts": {
            "query_newsbot_company_analysis": "**NewsBot API: Company Analysis Query**\n\nYou have indicated access to NewsBot API. For [Company Name] (Ticker: [Ticker Symbol]), formulate and (conceptually) execute a request to its main company analysis endpoint (e.g., `/api/v1/company-analysis/{ticker_symbol}`). Request news for the last 90 days (or align with [Report Depth]). Provide the (conceptual) raw JSON response or a summary if too large. Report API errors if they occur.",
            "interpret_newsbot_profile": "**NewsBot API: Interpret Profile**\n\nFrom the NewsBot API response for [Ticker Symbol], extract and present the company profile information (name, ticker, country, currency, exchange, IPO date, market cap, industry, logo URL, web URL) as a structured JSON object.",
            "interpret_newsbot_news_sentiment": "**NewsBot API: Interpret News & Sentiment**\n\nFrom 'news.articles' in NewsBot API response for [Ticker Symbol], list up to 10-15 key news items as a JSON array (keys: 'headline', 'source', 'date', 'sentiment_label', 'sentiment_score', 'ai_category'). Also, provide a JSON object summarizing sentiment distribution: {'positive_percentage': X, 'negative_percentage': Y, 'neutral_percentage': Z}.",
            "interpret_newsbot_stock_data": "**NewsBot API: Interpret Stock Data**\n\nFrom 'stock_data.prices' in NewsBot API response for [Ticker Symbol], summarize stock trends, list most recent closing price/date, and note price range. Output as a JSON object: {\"trend_summary\": \"...", \"recent_close\": {\"price\": X, \"date\": \"YYYY-MM-DD\"}, \"price_range_in_period\": {\"high\": Y, \"low\": Z}}."
          }
        },
        "3d_structured_data_sources": {
            "description": "Prompts for querying structured data sources if available (e.g., financial databases via code interpreter).",
            "prompts": {
                "query_financial_statements": "**Structured Data: Financial Statements Query**\n\nObjective: Retrieve key figures from official financial statements for [Company Name] (Ticker: [Ticker Symbol]). If you have access to a structured financial database (e.g., via code interpreter):\n1. Identify recent annual/quarterly statements (Income, Balance Sheet, Cash Flow).\n2. For last reported quarter & corresponding prior year quarter, extract: Total Revenue, Gross Profit, Net Income, EPS.\n3. For last reported annual & prior year, extract same figures.\n4. Present as a JSON object with nested objects for quarterly and annual data. Cite source/database and period end dates. If no direct access, state so."
            }
        }
      }
    },
    "4_analysis_and_synthesis": {
      "description": "Prompts for processing collected data and generating insights.",
      "prompts": {
        "news_sentiment_analysis": "**Analysis: News Sentiment for [Company Name]**\n\nInput: Collected news items (potentially with pre-calculated sentiment).\nTasks:\n1. If sentiment not pre-calculated, determine sentiment (Positive/Negative/Neutral) & score for each item.\n2. Calculate overall sentiment distribution (e.g., % Positive, % Negative, % Neutral).\n3. Identify top 2-3 news items with strongest positive sentiment & summarize why.\n4. Identify top 2-3 news items with strongest negative sentiment & summarize why.\n5. Note sentiment shifts over the period, if discernible.\nOutput: JSON object {\"overall_distribution\":{...}, \"strong_positive_drivers\":[{\"headline\":\"...",\"reason\":\"..."}], \"strong_negative_drivers\":[...], \"sentiment_trends\":\"..."}",
        "news_thematic_analysis": "**Analysis: News Themes for [Company Name]**\n\nInput: Collected news items.\nTasks:\n1. Review news, identify 3-5 dominant recurring themes (e.g., 'Product Innovation', 'Financial Performance Concerns').\n2. For each theme: describe it and cite 2-3 supporting news headlines/snippets.\n3. Note emergent themes.\nOutput: JSON array of themes, each object with 'theme_name', 'description', 'supporting_examples' (array of strings).",
        "financial_data_summary": "**Analysis: Financial Data Summary for [Company Name]**\n\nInput: Gathered financial data (earnings, stock performance).\nTasks:\n1. Consolidate key financial figures (Revenue, Net Income, EPS) from most recent period (quarterly/annual) with prior period comparisons (YoY growth).\n2. Summarize recent stock performance trends (e.g., 52-week high/low, performance over 3-6 months).\n3. Highlight standout financial metrics/trends (positive/negative).\nOutput: Narrative summary. Cite sources/periods.",
        "identify_catalysts_timelines": "**Analysis: Catalyst Identification for [Company Name]**\n\nInput: All gathered information.\nTasks:\n1. Identify 3-5 potential key future catalysts (positive/negative) for [Company Name] over next 6-18 months.\n2. For each: describe catalyst, estimate potential timeline, explain potential impact, cite source/reasoning.\nOutput: JSON array of catalysts, each object: {'catalyst_description': '...', 'estimated_timeline': '...', 'potential_impact': '...', 'justification_source': '...'}",
        "swot_analysis_generation": "**Analysis: SWOT for [Company Name]**\n\nInput: All gathered information.\nTasks: Identify 2-4 key Strengths (internal), Weaknesses (internal), Opportunities (external), Threats (external). Briefly explain each.\nOutput: JSON object {\"strengths\":[{\"point\":\"...",\"explanation\":\"..."}], \"weaknesses\":[...], \"opportunities\":[...], \"threats\":[...]}",
        "competitor_overview": "**Analysis: Competitor Overview for [Company Name]**\n\nInput: Company profile, news, web search for competitors.\nTasks:\n1. Identify 2-3 primary competitors in main business segments.\n2. For each: name, key area of competition.\n3. Briefly assess [Company Name]'s competitive position.\nOutput: Narrative summary including competitor list and positioning.",
        "risk_assessment_summary": "**Analysis: Risk Assessment for [Company Name]**\n\nInput: Filings (10-K risk factors), news, analyst opinions.\nTasks:\n1. Identify 3-5 significant risks (operational, financial, market, regulatory, tech).\n2. For each: describe risk, potential impact. Note stated mitigation strategies if found.\nOutput: JSON array of risks, each object: {'risk_description': '...', 'potential_impact': '...', 'stated_mitigation': '...' (optional)}",
        "market_trends_impact_analysis": "**Analysis: Market Trends Impact on [Company Name]**\n\nInput: Company profile (industry), industry news, market analysis.\nTasks:\n1. Identify 1-2 major current trends in [Company Name]'s primary industry.\n2. Analyze how each trend likely impacts [Company Name] (business, strategy, financials).\nOutput: Narrative summary of trends and their impact.",
        "overall_outlook_synthesis": "**Synthesis: Overall Outlook for [Company Name]**\n\nInput: All previous analyses.\nTasks:\n1. Formulate a balanced overall outlook for [Company Name] for next 6-12 months (or per [Report Depth]). Integrate key positive/negative factors (strengths, weaknesses, opportunities, threats, catalysts, risks, financials, news sentiment).\n2. Conclude with a brief summary statement of likely trajectory. Avoid direct investment advice unless specified and capable.\nOutput: Narrative outlook."
      }
    },
    "5_reporting_and_citation": {
      "description": "Prompts for formatting the final report and citing sources.",
      "prompts": {
        "compile_draft_report": "**Reporting: Compile Draft Report for [Company Name]**\n\nInput: All outputs from Data Gathering and Analysis & Synthesis phases.\nTasks:\n1. Organize information into a logical report structure (suggested: Intro/Company Overview, Recent News Analysis (Themes, Sentiment), Financial Snapshot, Key Catalysts, Strategic Analysis (SWOT, Competitors, Risks, Market Trends), Overall Outlook). Adjust structure as needed for clarity and [Report Depth].\n2. Write clear, concise text for each section. Ensure smooth transitions. Maintain professional/analytical tone.\n3. Note where specific citations are needed.\nOutput: Full draft report text (e.g., in Markdown). Indicate if any sections are incomplete due to data gaps.",
        "format_citations": "**Reporting: Format Citations for [Company Name] Report**\n\nInput: Draft report and list of all information sources used.\nTasks:\n1. Review draft. For every significant claim, data point, quote, or summarized finding from an external source, insert an inline citation (e.g., (Source Name, Date)) or numbered reference.\n2. Compile a bibliography/reference list at the end (e.g., `[#] Source Name. \"Article Title.\" URL. Accessed [Date information retrieved].`). Use a simple, consistent style.\nOutput: Report text with inline citations and an appended bibliography section.",
        "describe_methodology_confidence": "**Reporting: Methodology & Confidence Statement for [Company Name] Report**\n\nInput: Draft report and internal record of process (tools, sources, challenges).\nTasks: Draft 1-2 paragraphs for a 'Methodology and Confidence' section, describing: \na. Primary data gathering methods (e.g., 'Utilized NewsBot API, supplemented with web searches via [Tool Name]'). \nb. Main types of sources consulted. \nc. Overall confidence (High/Medium/Low) justified by data availability/reliability, info recency, and any data gaps. \nd. Standard disclaimer (AI-generated, informational purposes, not financial advice).\nOutput: Text block for this section.",
        "executive_summary_generation": "**Reporting: Executive Summary for [Company Name] Report**\n\nInput: Complete draft financial report.\nTasks: (Typically for 'detailed analysis' or 'executive overview' [Report Depth])\n1. Review full draft. Identify most critical findings, key insights, overall outlook.\n2. Condense into a brief executive summary (1-3 paragraphs) covering: company intro, significant recent developments, key financial health/performance, core future outlook message with key catalysts/risks. Maintain concise, high-level, impactful tone.\nOutput: Text for Executive Summary section."
      }
    }
  },
  "helper_instructions": {
    "usage_guide": "To use this library, start with the 'main_orchestrator' prompt in '1_orchestration'. The LLM will be guided to use other prompts based on its capabilities and the information needed. Replace placeholders like [Company Name] with actual values. The effectiveness of this library heavily relies on the underlying capabilities of the LLM being used, especially its ability to follow complex instructions, use tools, and switch context between different sub-tasks.",
    "customization_notes": "Prompt templates can be customized. The LLM's success will depend on its inherent capabilities and the tools it has access to. For prompts requesting JSON output, ensure the LLM version used is proficient in generating valid JSON according to the specified structure."
  }
}
